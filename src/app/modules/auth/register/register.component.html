<div id="main-container">
    <div id="error" [class.has-error]="error">{{error}}</div>
    <div class="container">
        <app-loader radius="25" *ngIf="loading"></app-loader>
        <a id="back" [routerLink]="callbackUrl"><span class="icon-chevron-left"></span> Retour</a>
        <div id="form">
            <h1>Créer un compte</h1>
            <div id="forms-container">
                <div [class.globalForm-valid]="globalFormValid" id="forms-slider">
                    <form id="global" [formGroup]="globalForm" (ngSubmit)="validateGlobalForm()">
                        <div class="field">
                            <input type="text" name="username" id="username" formControlName="username" [class.not-empty]="globalForm.controls.username.value != null && globalForm.controls.username.value != ''">
                            <label for="username"><span class="icon-user"></span> Nom d'utilisateur</label>
                            <div class="errors"
                                [class.visible]="!globalForm.controls.username.valid && globalForm.controls.username.touched">
                                <p
                                    [class.visible]="globalForm.controls.username.hasError('required') && globalForm.controls.username.touched">
                                    Champ requis</p>
                            </div>
                        </div>
                        <div class="field">
                            <input type="password" name="password" id="password" formControlName="password" [class.not-empty]="globalForm.controls.password.value != null && globalForm.controls.password.value != ''">
                            <label for="password"><span class="icon-lock"></span> Mot de passe</label>
                            <div class="errors"
                                [class.visible]="!globalForm.controls.password.valid && globalForm.controls.password.touched">
                                <p
                                    [class.visible]="globalForm.controls.password.hasError('required') && globalForm.controls.password.touched">
                                    Champ requis</p>
                                <p
                                    [class.visible]="globalForm.controls.password.hasError('minlength') && globalForm.controls.password.touched">
                                    Minimum 8 caractères</p>
                            </div>
                        </div>
                        <div class="field">
                            <input type="email" name="email" id="email" formControlName="email" [class.not-empty]="globalForm.controls.email.value != null && globalForm.controls.email.value != ''">
                            <label for="email"><span class="icon-mail"></span> Email</label>
                            <div class="errors"
                                [class.visible]="!globalForm.controls.email.valid && globalForm.controls.email.touched">
                                <p
                                    [class.visible]="globalForm.controls.email.hasError('required') && globalForm.controls.email.touched">
                                    Champ requis</p>
                                <p
                                    [class.visible]="globalForm.controls.email.hasError('pattern') && globalForm.controls.email.touched">
                                    Champ invalid</p>
                            </div>
                        </div>
                        <div id="submit">
                            <button type="submit" [disabled]="!globalForm.valid">Créer le compte</button>
                        </div>
                    </form>
                    <form id="usernameValidation" [formGroup]="globalForm" (ngSubmit)="register()">
                        <p>Est ce bien vous&nbsp;?</p>
                        <div id="show">
                            <img src="{{newUserSkinUrl}}" alt="">
                            <p *ngIf="!changingUserName">{{globalForm.controls.username.value}}</p>
                        </div>
                        <div *ngIf="!changingUserName" id="verify-skin">
                            <button type="submit" id="yes">Oui</button>
                            <button (click)="changingUserName = !changingUserName" id="no">Non</button>
                        </div>
                        <div id="remember-me" *ngIf="!changingUserName">
                            <input type="checkbox" name="rememberMe" id="rememberMe" formControlName="rememberMe">
                            <label for="rememberMe" class="box"><span class="icon-check"></span></label>
                            <label for="rememberMe" class="text">Se souvenir de moi</label>
                          </div>
                        <div *ngIf="changingUserName" id="change-username" onshow="verifyEmptyInput()">
                            <div class="field">
                                <input type="text" name="newUsername" id="newUsername" formControlName="username" [class.not-empty]="globalForm.controls.username.value != null && globalForm.controls.username.value != ''">
                                <label for="newUsername"><span class="icon-user"></span> Nouveau pseudo</label>
                                <div class="errors"
                                [class.visible]="!globalForm.controls.username.valid && globalForm.controls.username.touched">
                                <p
                                    [class.visible]="globalForm.controls.username.hasError('required') && globalForm.controls.username.touched">
                                    Champ requis</p>
                            </div>
                            </div>
                            <button class="btn btn-third animated" [disabled]="!globalForm.controls.username.valid" (click)="changeUsername()">Valider</button>
                        </div>
                    </form>
                </div>
            </div>
            <div id="have-account">
                <p>Vous avez déjà un compte&nbsp;?</p>
                <a routerLink="/login">Se connecter</a>
            </div>
        </div>
        <div id="picture-right">
            <img src="../../../../assets/pictures/register-picture.jpg" alt="">
        </div>
    </div>
</div>